Ocelot toevoegen

Ocelots primaire functionaliteit is rerouting van API gateway urls. 
Door de vele microservices is het lastig om de vele services van containers te vinden en te gebruiken. 
Ocelot kan de rerouten het voor de gateway of container makkelijker maken de api van de externe api's te benaderen door er een andere url route aan te koppelen.

Ocelot biedt ook andere handige functionaliteiten. Een voobeeld is aggregatie van services. Hiermee kan je de rest api data van verschillende API calls aggrereren. 
Andere functionaliteiten die Ocelot biedt zijn: caching, header transformation circuit breakers, service discovery tooling en nog veel meer.

Opdracht
----------------------------------------------------------------------------------------
Stap 1: Installeer package ocelot en MMLib.SwaggerForOcelot in de profile service gateway!

Stap 2: Voeg ocelot toe aan services (AddOcelot() en AddSwaggerForOcelot) en configure (UseOcelost(Configuration) en UseSwaggerForOcelotUI(Configuration)) in startup.cs!
----------------------------------------------------------------------------------------

Ocelot configuratie
----------------------------------------------------------------------------------------
Voeg de ocelot.json file config toe! In de ocelot JSON kun je zien dat downstream de ophaal api is van de gateway en upstream is de reroute van de URL naar een eigen url.
Hierdoor is de api van de container voor gateway betervoorspelbaar en makkelijker te benanderen. 

Stap 3: Voeg het laden van de ocelot.json toe aan de HostBuilder in Program.cs:
            .ConfigureAppConfiguration((hostingContext, config) =>
            {
                // Informs the app to use the ocelot.json file
                config.AddJsonFile("ocelot.json", optional:false, reloadOnChange: true);
            })


Stap 4: Voeg het ocelot bestand toe als content met copy if newer

Stap 5: Als je nu de gateway api in docker start (stel docker-compose eerst in als startup project!) zie je op de swagger pagina twee extra api's (FileController) die daar niet horen omdat dit van Ocelot zelf is.
Die gaan we eerst weg filteren.

Er is al een filter aanwezig hiervoor, deze moet toegevoegd worden.
Stap 6: Voeg in startup.cs aan swaggergen het volgende toe.
 c.DocumentFilter<HideOcelotControllersFilter>();
  
 

 ------------------------------------------------------------------------------------
 De oplossing van opdrachten 1 - 5 is te vinden in branche einde
 ------------------------------------------------------------------------------------
